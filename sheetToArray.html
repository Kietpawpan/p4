<!DOCTYPE html>

<html>
<head>
  
    <base target="_top">
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    <meta name="viewport" content="width=device-width; initial-scale=1.0; maximum-scale=1.0; minimum-scale=1.0; user-scalable=yes;" />
    <meta name="apple-mobile-web-app-capable" content="yes" />
     <link rel="stylesheet" href="css/style.css" />
</head>
<body>
<div>
    <div class="header-container">
      <div class="header-text">Table to JavaScript Array</div></div>





<center>
<form>
  <textarea id="cell" style="height:500px;width:98%;position:relative;">วิชา การบ้าน กำหนดส่ง ภาพ Status
ภาษาไทย คัดไทย เดือนนี้ https://www.google.com no
</textarea><br/>
  <button type="button" id="add" class="btn green">To javaScript Array</button>
  <button type="button" onclick="copyCode()" class="btn green">Copy</button>
  <button type="button" onclick="clearText()" class="btn green">Clear</button>
<br/>
<span style="font-size:12px;"> &copy; 2024 jTech (Thailand), MIT License</span>
<span style="font-size:12px;"onclick="help()">| Help</span>

</form>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
<script>


  $(document).ready(function() {
    $("#add").click(function() {
	var m=[];
       var data=[];
      var code=[];
      var cell = $("#cell").val().split('\n');
      var header = cell[0].split(" ");
	for(let i=1;i<cell.length-1;i++){
       m[i] = cell[i].split(" ");
		for(j=0;j<header.length;j++){
	if(j==0){
	data[i]= "\n{\n'"+ header[j] + "':'" + m[i][j] +"'";
	code.push(data[i]);}
	else if(j+1==header.length){
	data[i]= "\n'"+ header[j] + "':'" + m[i][j] +"'\n}";
	code.push(data[i]);}
	else{
	data[i]= "\n'"+ header[j] + "':'" + m[i][j] +"'";
	code.push(data[i]);}
}}
	document.getElementById("cell").value=code;
    });
  });

function copyCode() {
  const element = document.querySelector("#cell");
  element.select();
  element.setSelectionRange(0, 99999);
  document.execCommand('copy');
  element.setSelectionRange(0, 0);
  window.alert("Copied!");
}

function clearText() {
  const element = document.querySelector("#cell");
  element.select();
  element.setSelectionRange(0, 99999);
  document.execCommand('delete');
  element.setSelectionRange(0, 0);
}

function help(){
alert("INPUT DATA\nOn Row 1 are headers.\nThe next row values.\nSpaces divide columns.\nValues be space-free.\nNo space on borders.\nPress Enter at the last row ending.");
}



</script>


</body>
</html>
